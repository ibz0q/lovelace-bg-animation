const{PI,cos,sin,abs,sqrt,pow,round,random,atan2}=Math,HALF_PI=.5*PI,TAU=2*PI,TO_RAD=PI/180,floor=e=>0|e,rand=e=>e*random(),randIn=(e,a)=>rand(a-e)+e,randRange=e=>e-rand(2*e),fadeIn=(e,a)=>e/a,fadeOut=(e,a)=>(a-e)/a,fadeInOut=(e,a)=>{let n=.5*a;return abs((e+n)%a-n)/n},dist=(e,a,n,c)=>sqrt(pow(n-e,2)+pow(c-a,2)),angle=(e,a,n,c)=>atan2(c-a,n-e),lerp=(e,a,n)=>(1-n)*e+n*a,circleCount=120,circlePropCount=8,circlePropsLength=960,baseSpeed=.001,rangeSpeed=.001,baseTTL=150,rangeTTL=500,baseRadius=100,rangeRadius=500,rangeHue=120,xOff=.0015,yOff=.0015,zOff=.0015;let container,canvas,ctx,circles,circleProps,simplex,baseHue;function setup(){createCanvas(),resize(),initCircles(),draw()}function initCircles(){let e;for(circleProps=new Float32Array(960),simplex=new SimplexNoise,baseHue=220,e=0;e<960;e+=8)initCircle(e)}function initCircle(e){let a,n,c,r,t,i,s,o,d,l,u;a=rand(canvas.a.width),n=rand(canvas.a.height),c=simplex.noise3D(a*xOff,n*yOff,baseHue*zOff),r=rand(TAU),t=.001+rand(.001),i=t*cos(r),s=t*sin(r),o=0,d=150+rand(500),l=100+rand(500),u=baseHue+120*c,circleProps.set([a,n,i,s,0,d,l,u],e)}function updateCircles(){let e;for(baseHue++,e=0;e<960;e+=8)updateCircle(e)}function updateCircle(e){let a,n,c,r,t,i,s,o,d=1+e,l=2+e,u=3+e,p=4+e,f=5+e,v=6+e,h=7+e;a=circleProps[e],n=circleProps[d],c=circleProps[l],r=circleProps[u],t=circleProps[p],i=circleProps[f],s=circleProps[v],o=circleProps[h],drawCircle(a,n,t,i,s,o),t++,circleProps[e]=a+c,circleProps[d]=n+r,circleProps[p]=t,(checkBounds(a,n,s)||t>i)&&initCircle(e)}function drawCircle(e,a,n,c,r,t){ctx.a.save(),ctx.a.fillStyle=`hsla(${t},60%,30%,${fadeInOut(n,c)})`,ctx.a.beginPath(),ctx.a.arc(e,a,r,0,TAU),ctx.a.fill(),ctx.a.closePath(),ctx.a.restore()}function checkBounds(e,a,n){return e<-n||e>canvas.a.width+n||a<-n||a>canvas.a.height+n}function createCanvas(){container=document.querySelector(".canvas"),canvas={a:document.createElement("canvas"),b:document.createElement("canvas")},container.appendChild(canvas.b),ctx={a:canvas.a.getContext("2d"),b:canvas.b.getContext("2d")}}function resize(){const{innerWidth:e,innerHeight:a}=window;canvas.a.width=e,canvas.a.height=a,ctx.a.drawImage(canvas.b,0,0),canvas.b.width=e,canvas.b.height=a,ctx.b.drawImage(canvas.a,0,0)}function render(){ctx.b.save(),ctx.b.drawImage(canvas.a,0,0),ctx.b.restore()}function draw(){ctx.a.clearRect(0,0,canvas.a.width,canvas.a.height),ctx.b.fillRect(0,0,canvas.b.width,canvas.b.height),updateCircles(),render(),window.requestAnimationFrame(draw)}window.addEventListener("load",setup),window.addEventListener("resize",resize);